<!doctype html>
<html lang="ja">
<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="/libs/katex/katex.min.css">
   
   <link rel="stylesheet" href="/libs/highlight/styles/github.min.css">
   

  <link href="/css/franklin.css" rel="stylesheet">
<link href="/css/vela.css" rel="stylesheet">
<script src="/libs/vela/jquery.min.js"></script>

<link rel="icon" href="/assets/logakita.png">


  <title>Julia による Physics Informed Koopman Network</title>  <!-- ★修正点1: タイトルを動的に -->
  <link rel="canonical" href="https://akita-kosuke.github.io/pikn/index.html"> <!-- ★修正点2: Canonicalタグを追加 -->

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-71R5Z6V5CM"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-71R5Z6V5CM');
  </script>
</head>
<body>
<div class="main-nav slideout-menu slideout-menu-left" id="menu">
  <div class="flex-container">
    <span class="sidebar-brand">
      <h3 style='font-size: 25px'>Kosuke Akita</h3>
    </span>
  </div> <!-- class="flex-container" -->

  <nav class="sidebar-nav">
    <ul class="metismenu"  id="metismenu" >
      <li><a href="/">Home</a></li>
      <li><a href="/papers/">Papers and Talks</a></li>
      <li><a href="" class="has-arrow">Topic</a>
        <ul>
          <li><a href="/pikn/">Julia</a></li>
          <li><a href="/katexmath/">KaTeX 練習</a></li>
        </ul>
      </li>
      <li><a href="/others/">Others</a></li>
    </ul>
  </nav>
</div> <!-- main nav menu -->

<main id="panel" class="slideout-panel slideout-panel-left">
  <div class="toggle-button hamburger hamburger--spin">
    <div class="hamburger-box">
      <div class="hamburger-inner"></div>
    </div>
  </div>
  <h1 class="page title">Julia による Physics Informed Koopman Network</h1>
  <hr>



<!-- Content appended here -->
<div class="franklin-content">
<h1 id="はじめに準備"><a href="#はじめに準備" class="header-anchor">はじめに（準備）</a></h1>
<h2 id="数学的準備"><a href="#数学的準備" class="header-anchor">数学的準備</a></h2>
<p>以下の常微分方程式</p>
\[\begin{aligned}
\frac{d}{dt} \bm{x}(t) = \bm{f}(\bm{x}(t))
\end{aligned}\]
<p>に対して，シミュレーション\(\bm{F}: \mathbb{R}^k \righarrow \mathbb{R}\k \) を用いて，</p>
\[\begin{aligned}
\bm{x}_t = \bm{F}(\bm{x}_{t-1})
\end{aligned}\]
<p>による時間発展の記述を考える．</p>
<h2 id="使用パッケージ"><a href="#使用パッケージ" class="header-anchor">使用パッケージ</a></h2>
<pre><code class="language-julia-repl">julia&gt; using LinearAlgebra
julia&gt; using Plots
julia&gt; using ReverseDiff # Zygoteは用いない
julia&gt; using Optimisers</code></pre>
<h1 id="数値実験"><a href="#数値実験" class="header-anchor">数値実験</a></h1>
<p>ここでは，簡単に以下の連立常微分方程式</p>
\[\begin{aligned}
\frac{dx_1}{dt}& = \mu x_1 \\
\frac{dx_2}{dt}& = \lambfa (x_2 - x_1^2)
\end{aligned}\]
<p>に対して適用を試みる．ただし，\(\mu = -0.1\)，\(\lambda = -1\) と設定する．</p>
<pre><code class="language-julia-repl"># --- 1. システムダイナミクスの定義 &#40;変更なし&#41; ---
julia&gt;const μ &#61; -0.1f0
julia&gt;const λ &#61; -1.0f0

function simple&#40;x&#41;
    dx1 &#61; μ * x&#91;1&#93;
    dx2 &#61; λ * &#40;x&#91;2&#93; - x&#91;1&#93;^2&#41;
    return &#91;dx1, dx2&#93;
end</code></pre>
<p>次に，ニューラルネットを構成する．2層の FNN を用いることにし，</p>
<pre><code class="language-julia-repl"># --- 2. モデルの定義 &#40;変更なし&#41; ---
encoder &#61; Chain&#40;
    Dense&#40;2 &#61;&gt; 50, elu&#41;,
    Dense&#40;50 &#61;&gt; 50, elu&#41;,
    Dense&#40;50 &#61;&gt; 3&#41;
&#41;
decoder &#61; Dense&#40;3 &#61;&gt; 2; bias&#61;false&#41;
L &#61; 2*rand&#40;Float32, 3, 3&#41; .- 1.0f0

# 学習対象のパラメータを一つのNamedTupleにまとめる
# ReverseDiffは、パラメータを平坦な一つのベクトルとして扱う必要がある
p_initial, re &#61; Flux.destructure&#40;&#40;encoder&#61;encoder, decoder&#61;decoder, L&#61;L&#41;&#41;</code></pre>
<h1 id="参考文献"><a href="#参考文献" class="header-anchor">参考文献</a></h1>
<div class="page-foot">
    <a href="http://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> Kosuke Akita.
    Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
</div>
</div><!-- CONTENT ENDS HERE -->
  </main> <!-- end of id=main -->
  <script src="/libs/vela/metisMenu.min.js"></script>
  <script src="/libs/vela/slideout.min.js"></script>
  
    <script src="/libs/katex/katex.min.js"></script>
<script src="/libs/katex/contrib/auto-render.min.js"></script>
<script>renderMathInElement(document.body)</script>

  
  
    <script src="/libs/highlight/highlight.min.js"></script>
<script>hljs.highlightAll();hljs.configure({tabReplace: '    '});</script>

  
</body>
</html>
